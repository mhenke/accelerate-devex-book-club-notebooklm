<!-- Reusable Interactive Learning Checkpoint Grid Component -->
<!-- 
Usage: Creates checkpoint cards with grid layouts (grid-2, grid-3, etc.)
Parameters:
- title: Checkpoint title (required)
- icon: FontAwesome icon class (optional)
- question: Question text (optional)
- layout: Layout type (grid-2, grid-3, horizontal) (optional)
- answers: Array of answers from checkpoint_answers.yml (required)
- feedback_id: ID for feedback area (optional)
- radio_name: Name attribute for radio buttons (optional)
- card_class: CSS class for styling (optional)
- default_feedback: Default feedback message (optional)
-->

<div
  class="checkpoint-card {{ include.card_class | default: 'generic-checkpoint' }}"
  markdown="0"
>
  <h4>
    {% if include.icon %}<i class="{{ include.icon }}"></i>{% endif %} {{
    include.title }}
  </h4>
  {% if include.question %}
  <p>{{ include.question }}</p>
  {% endif %} {% if include.answers %}
  <div
    class="{% if include.layout == 'grid-2' %}priority-selector{% else %}assessment-buttons{% endif %}"
    markdown="0"
  >
    {% for answer in include.answers %}
    <label
      class="assessment-btn {{ answer.performance_class | default: 'performance-medium' }}"
    >
      <input
        type="radio"
        name="{{ include.radio_name | default: 'checkpoint' }}"
        value="{{ answer.value }}"
      />
      <span class="radio-mark"></span>
      {{ answer.text }}
    </label>
    {% endfor %}
  </div>
  {% endif %} {% if include.feedback_id %}
  <div class="feedback-area" id="{{ include.feedback_id }}">
    <p>
      {{ include.default_feedback | default: 'Make a selection to see
      personalized feedback.' }}
    </p>
  </div>
  {% endif %}
</div>

<style>
  /* Checkpoint grid styling - inherits from checkpoint-card but adds grid layouts */
  .generic-checkpoint {
    background: white;

    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    border-left: 4px solid #1e3a8a;
    transition: all 0.3s ease;
  }

  .generic-checkpoint:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
  }

  .generic-checkpoint h4 {
    margin: 0 0 1rem 0;
    color: #1e40af;
    font-size: 1.3rem;
    font-weight: 600;
  }

  .generic-checkpoint h4 i {
    margin-right: 0.5rem;
    color: inherit;
  }

  .generic-checkpoint p {
    color: #666;
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
  }

  /* Grid layouts */
  .priority-selector {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .assessment-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  /* Assessment button styling */
  .assessment-btn {
    position: relative;
    display: flex;
    align-items: center;
    padding: 1rem;
    background: white;
    border: 2px solid #e2e8f0;

    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    line-height: 1.4;
    text-align: left;
    justify-content: flex-start;
  }

  .priority-selector .assessment-btn {
    flex-direction: column;
    text-align: center;
    padding: 1.5rem 1rem;
    min-height: 120px;
    justify-content: center;
    align-items: center;
  }

  .assessment-btn:hover {
    border-color: #cbd5e1;
    transform: translateY(-2px);
  }

  .priority-selector .assessment-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }

  .assessment-btn input[type="radio"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
  }

  .assessment-btn .radio-mark {
    width: 20px;
    height: 20px;
    border: 2px solid #cbd5e1;
    border-radius: 50%;
    margin-right: 1rem;
    position: relative;
    flex-shrink: 0;
    transition: all 0.3s ease;
  }

  .priority-selector .assessment-btn .radio-mark {
    margin: 0 0 0.5rem 0;
  }

  .assessment-btn input[type="radio"]:checked + .radio-mark {
    border-color: #1e40af;
    background: #1e40af;
  }

  .assessment-btn input[type="radio"]:checked + .radio-mark::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    transform: translate(-50%, -50%);
  }

  .assessment-btn input[type="radio"]:checked ~ * {
    color: #1e40af;
  }

  /* Performance level styling - only show colors when selected */
  .assessment-btn.performance-high input[type="radio"]:checked + .radio-mark {
    border-color: #16a34a;
    background: #16a34a;
  }

  .assessment-btn.performance-medium input[type="radio"]:checked + .radio-mark {
    border-color: #d97706;
    background: #d97706;
  }

  .assessment-btn.performance-low input[type="radio"]:checked + .radio-mark {
    border-color: #dc2626;
    background: #dc2626;
  }

  /* Feedback area */
  .generic-checkpoint .feedback-area {
    margin-top: 1.5rem;
    padding: 1rem;
    background: #f8f9fa;
    border-left: 4px solid #1e3a8a;

    min-height: 60px;
    transition: all 0.3s ease;
  }

  .generic-checkpoint .feedback-area.active {
    background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
  }

  .generic-checkpoint .feedback-area h5 {
    margin: 0 0 0.5rem 0;
    color: #1e40af;
    font-size: 1rem;
    font-weight: 600;
  }

  .generic-checkpoint .feedback-area p {
    margin: 0;
    font-size: 0.9rem;
    line-height: 1.4;
  }

  /* Responsive design */
  @media (max-width: 768px) {
    .generic-checkpoint {
      padding: 1.25rem;
    }

    .priority-selector {
      grid-template-columns: 1fr;
    }

    .priority-selector .assessment-btn {
      min-height: 100px;
      padding: 1.25rem 1rem;
    }

    .assessment-btn {
      padding: 0.75rem;
    }

    .assessment-btn .radio-mark {
      width: 18px;
      height: 18px;
      margin-right: 0.75rem;
    }

    .priority-selector .assessment-btn .radio-mark {
      margin: 0 0 0.5rem 0;
    }

    .assessment-btn input[type="radio"]:checked + .radio-mark::after {
      width: 6px;
      height: 6px;
    }
  }
</style>

<script>
  // Checkpoint grid interactivity
  document.addEventListener('DOMContentLoaded', function () {
    // Handle all checkpoint grid interactions
    const checkpointGrids = document.querySelectorAll('.generic-checkpoint');

    checkpointGrids.forEach((card) => {
      const radioInputs = card.querySelectorAll('input[type="radio"]');
      const feedbackArea = card.querySelector('.feedback-area');

      if (radioInputs.length > 0 && feedbackArea) {
        radioInputs.forEach((input) => {
          input.addEventListener('change', function () {
            // Add visual feedback
            feedbackArea.classList.add('active');

            // Update feedback based on performance class
            const label = this.closest('.assessment-btn');
            const performanceClass = Array.from(label.classList).find((cls) =>
              cls.startsWith('performance-')
            );

            let feedbackTitle = '';
            let feedbackContent = '';
            let borderColor = '#1E3A8A';

            if (performanceClass === 'performance-high') {
              feedbackTitle = 'ðŸš€ High Performance Choice';
              feedbackContent =
                'Excellent selection! This approach is strongly associated with high delivery performance according to Accelerate research.';
              borderColor = '#16a34a';
              feedbackArea.style.background =
                'linear-gradient(135deg, #e8f8f5, #d1f2eb)';
            } else if (performanceClass === 'performance-medium') {
              feedbackTitle = 'âš¡ Good Direction';
              feedbackContent =
                'Solid choice! This represents good progress with opportunities to advance toward elite performance.';
              borderColor = '#d97706';
              feedbackArea.style.background =
                'linear-gradient(135deg, #fff3cd, #ffeaa7)';
            } else if (performanceClass === 'performance-low') {
              feedbackTitle = 'ðŸ”§ Growth Opportunity';
              feedbackContent =
                'This represents a significant opportunity for improvement to boost delivery performance and team effectiveness.';
              borderColor = '#dc2626';
              feedbackArea.style.background =
                'linear-gradient(135deg, #f8d7da, #f5c6cb)';
            }

            feedbackArea.style.borderLeftColor = borderColor;
            feedbackArea.innerHTML = `
            <h5 class="feedback-title">${feedbackTitle}</h5>
            <p class="feedback-text">${feedbackContent}</p>
          `;
            const titleEl = feedbackArea.querySelector('.feedback-title');
            if (titleEl) {
              titleEl.style.color = borderColor;
            }
          });
        });
      }
    });
  });
</script>
