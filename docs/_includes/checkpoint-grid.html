<!-- Reusable Interactive Learning Checkpoint Grid Component -->
<!-- 
Usage: Creates checkpoint cards with grid layouts (grid-2, grid-3, etc.)
Parameters:
- title: Checkpoint title (required)
- icon: FontAwesome icon class (optional)
- question: Question text (optional)
- layout: Layout type (grid-2, grid-3, horizontal) (optional)
- answers: Array of answers from checkpoint_answers.yml (required)
- feedback_id: ID for feedback area (optional)
- radio_name: Name attribute for radio buttons (optional)
- card_class: CSS class for styling (optional)
- default_feedback: Default feedback message (optional)
-->

<div
  class="checkpoint-card {{ include.card_class | default: 'generic-checkpoint' }}"
  markdown="0"
>
  <h4>
    {% if include.icon %}<i class="{{ include.icon }}"></i>{% endif %} {{
    include.title }}
  </h4>
  {% if include.question %}
  <p>{{ include.question }}</p>
  {% endif %} {% if include.answers %}
  <div
    class="{% if include.layout == 'grid-2' %}priority-selector{% else %}assessment-buttons{% endif %}"
    markdown="0"
  >
    {% for answer in include.answers %}
    <label
      class="assessment-btn {{ answer.performance_class | default: 'performance-medium' }}"
    >
      <input
        type="radio"
        name="{{ include.radio_name | default: 'checkpoint' }}"
        value="{{ answer.value }}"
      />
      <span class="radio-mark"></span>
      {{ answer.text }}
    </label>
    {% endfor %}
  </div>
  {% endif %} {% if include.feedback_id %}
  <div class="feedback-area" id="{{ include.feedback_id }}">
    <p>
      {{ include.default_feedback | default: 'Make a selection to see
      personalized feedback.' }}
    </p>
  </div>
  {% endif %}
</div>


<script>
  // Checkpoint grid interactivity
  document.addEventListener('DOMContentLoaded', function () {
    // Handle all checkpoint grid interactions
    const checkpointGrids = document.querySelectorAll('.generic-checkpoint');

    checkpointGrids.forEach((card) => {
      const radioInputs = card.querySelectorAll('input[type="radio"]');
      const feedbackArea = card.querySelector('.feedback-area');

      if (radioInputs.length > 0 && feedbackArea) {
        radioInputs.forEach((input) => {
          input.addEventListener('change', function () {
            // Add visual feedback
            feedbackArea.classList.add('active');

            // Update feedback based on performance class
            const label = this.closest('.assessment-btn');
            const performanceClass = Array.from(label.classList).find((cls) =>
              cls.startsWith('performance-')
            );

            let feedbackTitle = '';
            let feedbackContent = '';
            let borderColor = '#1E3A8A';

            if (performanceClass === 'performance-high') {
              feedbackTitle = 'ðŸš€ High Performance Choice';
              feedbackContent =
                'Excellent selection! This approach is strongly associated with high delivery performance according to Accelerate research.';
              borderColor = '#16a34a';
              feedbackArea.style.background =
                'linear-gradient(135deg, #e8f8f5, #d1f2eb)';
            } else if (performanceClass === 'performance-medium') {
              feedbackTitle = 'âš¡ Good Direction';
              feedbackContent =
                'Solid choice! This represents good progress with opportunities to advance toward elite performance.';
              borderColor = '#d97706';
              feedbackArea.style.background =
                'linear-gradient(135deg, #fff3cd, #ffeaa7)';
            } else if (performanceClass === 'performance-low') {
              feedbackTitle = 'ðŸ”§ Growth Opportunity';
              feedbackContent =
                'This represents a significant opportunity for improvement to boost delivery performance and team effectiveness.';
              borderColor = '#dc2626';
              feedbackArea.style.background =
                'linear-gradient(135deg, #f8d7da, #f5c6cb)';
            }

            feedbackArea.style.borderLeftColor = borderColor;
            feedbackArea.innerHTML = `
            <h5 class="feedback-title">${feedbackTitle}</h5>
            <p class="feedback-text">${feedbackContent}</p>
          `;
            const titleEl = feedbackArea.querySelector('.feedback-title');
            if (titleEl) {
              titleEl.style.color = borderColor;
            }
          });
        });
      }
    });
  });
</script>
